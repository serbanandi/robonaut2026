# ZMQ interface description
This document describes the ZeroMQ (ZMQ) interface provided by the UART server for communication with other components, such as telemetry clients. The ZMQ interface allows for efficient and flexible message passing using the PUB-SUB and REQ-REP patterns.

## PUB-SUB operations
The UART server uses a PUB socket to broadcast messages to any subscribed clients. The following message types are published:

### Log messages
Log messages generated by the UART server are published on the PUB socket. Each log message contains has the following format:

`LOG <timestamp_ms> <log_level> <message>`, where:
- `<timestamp_ms>`: The timestamp of the log message in milliseconds.
- `<log_level>`: The log level (0 - DEBUG, 1 - INFO, 2 - WARN, 3 - ERROR).
- `<message>`: The log message string.

### Variable value update notifications
When a registered variable's value is updated, the UART server publishes a notification on the PUB socket in the following format:

`VAR <var_name> <var_value>`, where:
- `<var_name>`: The name of the variable (string).
- `<var_value>`: The updated value of the variable (format depends on variable type).

## REQ-REP operations
The UART server uses a REP socket to respond to requests from clients. The following request types are supported:

### Retrieve log history
Clients can request the log history stored in the UART server by sending the following request:

`LOGS <count>`, where 
- `<count>` is the number of log messages to retrieve (maximum is defined by `ZMQS_MAX_LOG_HISTORY`).

The server responds with a message containing the requested log messages in the following format:

`LOGS <count>\0{BINARY_LOG_LIST}`, where:
- `<count>`: The number of log messages being sent.
- `{BINARY_LOG_LIST}`: A binary blob containing the log messages. Each log message in the blob has the following structure:
    - 4 bytes: timestamp in milliseconds (uint32_t)
    - 1 byte: log level (0 - DEBUG, 1 - INFO, 2 - WARN, 3 - ERROR)
    - N bytes: log message string (null-terminated)
If the requested count exceeds the number of stored log messages, the server will return all available log messages.

### Variable list request
Clients can request the list of currently registered variables that can be read or written via telemetry by sending the following request:

`VARLIST`

The server responds with a message containing the list of registered variables in the following format:

`VARLIST <N> <var1_name> <var1_type> <var1_access> ... <varN_name> <varN_type> <varN_access>`, where:
- `<N>`: The number of registered variables.
- For each variable:
    - `<var_name>`: The name of the variable (string).
    - `<var_type>`: The type of the variable (0 - uint8_t, 1 - int8_t, 2 - uint16_t, 3 - int16_t, 4 - uint32_t, 5 - int32_t, 6 - float).
    - `<var_access>`: The access level of the variable (0 - read-only, 1 - writable).

### Variable write request
Clients can write a value to a registered variable by sending the following request:

`SET <var_name> <var_value>`, where:
- `<var_name>`: The name of the variable to write to (string).
- `<var_value>`: The value to write to the variable (format depends on variable type).

The server responds with an acknowledgment message:

`OK` if the write operation was successful, or `ERR <error_message>` if there was an error (e.g., variable not found, read-only variable).

### Text input submission
Clients can send text input to the UART server by sending the following request:

`TEXT <input_string>`, where:
- `<input_string>`: The text input string (not null-terminated).
